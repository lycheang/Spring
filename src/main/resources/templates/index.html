<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course & Teacher Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tab-content > div:not(.active) {
            display: none;
        }
        .tab-content > div.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
<div class="container mx-auto px-4 py-8 max-w-6xl">
    <h1 class="text-3xl font-bold text-center mb-8 text-gray-900">Course & Teacher Management</h1>

    Tab Navigation
    <div class="border-b border-gray-200 mb-6">
        <nav class="flex space-x-8">
            <button onclick="switchTab('courses')" id="courses-tab" class="py-2 px-1 border-b-2 border-blue-500 text-blue-600 font-medium">
                Courses
            </button>
            <button onclick="switchTab('teachers')" id="teachers-tab" class="py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium">
                Teachers
            </button>
        </nav>
    </div>

    Tab Content
    <div class="tab-content">
        Courses Tab
        <div id="courses" class="active">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h2 class="text-xl font-semibold text-gray-900">Manage Courses</h2>
                </div>
                <div class="p-6">
                    Create Course Form
                    <div class="mb-8">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Create New Course</h3>
                        <form id="createCourseForm" class="space-y-4">
                            <div>
                                <input type="text" id="courseName" placeholder="Course Name" required
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <input type="text" id="courseDescription" placeholder="Course Description" required
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                Create Course
                            </button>
                            <div id="createCourseOutput" class="text-sm text-green-600"></div>
                        </form>
                    </div>

                    <hr class="my-8">

                    Course List
                    <div>
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Course List</h3>
                        <div class="flex items-center gap-4 mb-4">
                            <div class="flex items-center gap-2">
                                <label class="text-sm text-gray-600">Page:</label>
                                <input type="number" id="coursePageInput" value="0" min="0"
                                       class="w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500">
                            </div>
                            <div class="flex items-center gap-2">
                                <label class="text-sm text-gray-600">Size:</label>
                                <input type="number" id="courseSizeInput" value="10" min="1"
                                       class="w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500">
                            </div>
                            <button onclick="getPaginatedCourses()" class="bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 text-sm">
                                Load Courses
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="coursesTableBody" class="bg-white divide-y divide-gray-200">
                                Course rows will be inserted here
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        Teachers Tab
        <div id="teachers">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h2 class="text-xl font-semibold text-gray-900">Manage Teachers</h2>
                </div>
                <div class="p-6">
                    Create Teacher Form
                    <div class="mb-8">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Create New Teacher</h3>
                        <form id="createTeacherForm" class="space-y-4">
                            <div>
                                <input type="text" id="teacherName" placeholder="Name" required
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <input type="text" id="teacherGender" placeholder="Gender" required
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <input type="text" id="teacherPhone" placeholder="Phone" required
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <div>
                                <input type="email" id="teacherEmail" placeholder="Email" required
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            </div>
                            <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                Create Teacher
                            </button>
                            <div id="createTeacherOutput" class="text-sm text-green-600"></div>
                        </form>
                    </div>

                    <hr class="my-8">

                    Teacher List
                    <div>
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Teacher List</h3>
                        <button onclick="getAllTeachers()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 mb-4">
                            Load All Teachers
                        </button>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Gender</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Phone</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                                </thead>
                                <tbody id="teachersTableBody" class="bg-white divide-y divide-gray-200">
                                Teacher rows will be inserted here
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const COURSE_API_URL = 'http://localhost:8080/api/v1/course';
    const TEACHER_API_URL = 'http://localhost:8080/api/v1/teachers';

    // Tab switching functionality
    function switchTab(tabName) {
        // Hide all tabs
        document.querySelectorAll('.tab-content > div').forEach(tab => {
            tab.classList.remove('active');
        });

        // Remove active state from all tab buttons
        document.querySelectorAll('nav button').forEach(btn => {
            btn.classList.remove('border-blue-500', 'text-blue-600');
            btn.classList.add('border-transparent', 'text-gray-500');
        });

        // Show selected tab
        document.getElementById(tabName).classList.add('active');

        // Activate selected tab button
        const activeBtn = document.getElementById(tabName + '-tab');
        activeBtn.classList.remove('border-transparent', 'text-gray-500');
        activeBtn.classList.add('border-blue-500', 'text-blue-600');
    }

    // Course Functions
    async function getPaginatedCourses() {
        const page = document.getElementById('coursePageInput').value;
        const size = document.getElementById('courseSizeInput').value;
        try {
            const response = await fetch(`${COURSE_API_URL}/pagination?page=${page}&size=${size}`);
            if (!response.ok) throw new Error('Failed to fetch courses');
            const data = await response.json();
            renderCoursesTable(data.courses);
        } catch (error) {
            console.error('Error fetching courses:', error);
            document.getElementById('coursesTableBody').innerHTML = '<tr><td colspan="3" class="px-6 py-4 text-center text-red-600">Error fetching data.</td></tr>';
        }
    }

    function renderCoursesTable(courses) {
        const tbody = document.getElementById('coursesTableBody');
        tbody.innerHTML = '';
        if (courses.length === 0) {
            tbody.innerHTML = '<tr><td colspan="3" class="px-6 py-4 text-center text-gray-500">No courses found.</td></tr>';
            return;
        }
        courses.forEach(course => {
            const row = `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${course.name}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${course.description}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button onclick="updateCourse('${course.uuid}')" class="text-yellow-600 hover:text-yellow-900 mr-3">Edit</button>
                        </td>
                    </tr>
                `;
            tbody.innerHTML += row;
        });
    }

    function updateCourse(uuid) {
        alert('Edit functionality not implemented yet for course: ' + uuid);
    }

    document.getElementById('createCourseForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const course = {
            name: document.getElementById('courseName').value,
            description: document.getElementById('courseDescription').value,
        };
        try {
            const response = await fetch(`${COURSE_API_URL}/create`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(course),
            });
            const result = await response.text();
            document.getElementById('createCourseOutput').textContent = result;
            if (response.ok) {
                getPaginatedCourses();
                document.getElementById('createCourseForm').reset();
            }
        } catch (error) {
            document.getElementById('createCourseOutput').textContent = 'Failed to create course.';
            document.getElementById('createCourseOutput').className = 'text-sm text-red-600';
        }
    });

    // Teacher Functions
    async function getAllTeachers() {
        try {
            const response = await fetch(TEACHER_API_URL);
            if (!response.ok) throw new Error('Failed to fetch teachers');
            const teachers = await response.json();
            renderTeachersTable(teachers);
        } catch (error) {
            console.error('Error fetching teachers:', error);
            document.getElementById('teachersTableBody').innerHTML = '<tr><td colspan="5" class="px-6 py-4 text-center text-red-600">Error fetching data.</td></tr>';
        }
    }

    function renderTeachersTable(teachers) {
        const tbody = document.getElementById('teachersTableBody');
        tbody.innerHTML = '';
        if (teachers.length === 0) {
            tbody.innerHTML = '<tr><td colspan="5" class="px-6 py-4 text-center text-gray-500">No teachers found.</td></tr>';
            return;
        }
        teachers.forEach(teacher => {
            const row = `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${teacher.name}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${teacher.gender}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${teacher.phone}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${teacher.email}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button onclick="deleteTeacher('${teacher.uuid}')" class="text-red-600 hover:text-red-900">Delete</button>
                        </td>
                    </tr>
                `;
            tbody.innerHTML += row;
        });
    }

    document.getElementById('createTeacherForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const teacher = {
            name: document.getElementById('teacherName').value,
            gender: document.getElementById('teacherGender').value,
            phone: document.getElementById('teacherPhone').value,
            email: document.getElementById('teacherEmail').value,
        };
        try {
            const response = await fetch(TEACHER_API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(teacher)
            });
            const result = await response.text();
            document.getElementById('createTeacherOutput').textContent = result;
            if (response.ok) {
                getAllTeachers();
                document.getElementById('createTeacherForm').reset();
            }
        } catch (error) {
            document.getElementById('createTeacherOutput').textContent = 'Failed to create teacher.';
            document.getElementById('createTeacherOutput').className = 'text-sm text-red-600';
        }
    });

    async function deleteTeacher(uuid) {
        if (!confirm('Are you sure you want to delete this teacher?')) return;
        try {
            const response = await fetch(`${TEACHER_API_URL}/${uuid}`, { method: 'DELETE' });
            if (response.ok) {
                getAllTeachers();
            } else {
                alert('Failed to delete teacher.');
            }
        } catch (error) {
            alert('An error occurred during deletion.');
        }
    }

    // Initial load
    document.addEventListener('DOMContentLoaded', () => {
        getPaginatedCourses();
    });
</script>
</body>
</html>
